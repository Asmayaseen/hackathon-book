"use strict";(globalThis.webpackChunkfrontend=globalThis.webpackChunkfrontend||[]).push([[653],{2229:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var a=t(6540),n=t(7283),o=t(9343),r=t(4848);function i(){const[e,s]=(0,a.useState)([]),[t,i]=(0,a.useState)(""),[c,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[h,m]=(0,a.useState)(!1),g=(0,a.useRef)(null),p=(0,a.useRef)(null),x="https://your-backend-url.com/api";(0,a.useEffect)(()=>{j()},[]),(0,a.useEffect)(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[e]);const j=async()=>{try{const e=await fetch(`${x}/rag/status`),s=await e.json();u(s)}catch(e){console.error("Error fetching RAG status:",e)}},f=async()=>{if(!t.trim()||c)return;const e={role:"user",content:t};s(s=>[...s,e]),i(""),l(!0);try{const e=await fetch(`${x}/rag/chat/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t,k:4,model:"gpt-3.5-turbo"})});if(!e.ok)throw new Error("Failed to get response");const a=await e.json(),n={role:"assistant",content:a.answer,sources:a.sources};s(e=>[...e,n])}catch(a){console.error("Error:",a);const e={role:"assistant",content:"Sorry, I encountered an error. Please try again."};s(s=>[...s,e])}finally{l(!1)}};return(0,r.jsx)(n.A,{title:"RAG Chat",description:"Chat with your documents using RAG",children:(0,r.jsxs)("div",{className:o.A.chatContainer,children:[(0,r.jsxs)("div",{className:o.A.chatHeader,children:[(0,r.jsx)("h1",{children:"\ud83d\udcda RAG Document Chat"}),d&&(0,r.jsxs)("div",{className:o.A.statusBadge,children:[(0,r.jsx)("span",{className:d.is_initialized?o.A.statusGreen:o.A.statusRed,children:d.is_initialized?"\u25cf Ready":"\u25cf Not Initialized"}),d.vectorstore_stats?.total_vectors>0&&(0,r.jsxs)("span",{className:o.A.statusInfo,children:[d.vectorstore_stats.total_vectors," chunks indexed"]})]})]}),(0,r.jsxs)("div",{className:o.A.uploadSection,children:[(0,r.jsx)("input",{ref:p,type:"file",accept:".pdf,.txt,.md",onChange:async e=>{const s=e.target.files?.[0];if(!s)return;const t=[".pdf",".txt",".md"],a=s.name.substring(s.name.lastIndexOf(".")).toLowerCase();if(t.includes(a)){m(!0);try{const e=new FormData;e.append("file",s);const t=await fetch(`${x}/rag/ingest/upload`,{method:"POST",body:e});if(!t.ok)throw new Error("Failed to upload file");const a=await t.json();alert(`File uploaded successfully!\nDocuments: ${a.documents_loaded}\nChunks: ${a.chunks_created}`),await j()}catch(n){console.error("Upload error:",n),alert("Failed to upload file. Please try again.")}finally{m(!1),p.current&&(p.current.value="")}}else alert(`Unsupported file type. Allowed: ${t.join(", ")}`)},style:{display:"none"}}),(0,r.jsx)("button",{onClick:()=>p.current?.click(),className:o.A.uploadButton,disabled:h,children:h?"\u23f3 Uploading...":"\ud83d\udcc4 Upload Document"}),(0,r.jsx)("small",{children:"Supported: PDF, TXT, MD"})]}),(0,r.jsxs)("div",{className:o.A.messagesContainer,children:[0===e.length?(0,r.jsxs)("div",{className:o.A.emptyState,children:[(0,r.jsx)("h2",{children:"\ud83d\udc4b Welcome to RAG Chat!"}),(0,r.jsx)("p",{children:"Upload documents and ask questions about them."}),(0,r.jsxs)("div",{className:o.A.suggestions,children:[(0,r.jsx)("h3",{children:"Try asking:"}),(0,r.jsx)("button",{onClick:()=>i("What is ROS 2?"),className:o.A.suggestionButton,children:'"What is ROS 2?"'}),(0,r.jsx)("button",{onClick:()=>i("Explain Isaac Sim"),className:o.A.suggestionButton,children:'"Explain Isaac Sim"'}),(0,r.jsx)("button",{onClick:()=>i("How does SLAM work?"),className:o.A.suggestionButton,children:'"How does SLAM work?"'})]})]}):e.map((e,s)=>(0,r.jsxs)("div",{className:`${o.A.message} ${o.A[e.role]}`,children:[(0,r.jsx)("div",{className:o.A.messageContent,children:e.content}),e.sources&&e.sources.length>0&&(0,r.jsxs)("details",{className:o.A.sources,children:[(0,r.jsxs)("summary",{children:["\ud83d\udcd6 Sources (",e.sources.length,")"]}),(0,r.jsx)("div",{className:o.A.sourcesList,children:e.sources.map((e,s)=>(0,r.jsxs)("div",{className:o.A.source,children:[(0,r.jsxs)("strong",{children:["Source ",s+1,":"]})," ",e.source,(0,r.jsxs)("p",{children:[e.content.substring(0,200),"..."]})]},s))})]})]},s)),c&&(0,r.jsx)("div",{className:`${o.A.message} ${o.A.assistant}`,children:(0,r.jsxs)("div",{className:o.A.loadingDots,children:[(0,r.jsx)("span",{children:"\u25cf"}),(0,r.jsx)("span",{children:"\u25cf"}),(0,r.jsx)("span",{children:"\u25cf"})]})}),(0,r.jsx)("div",{ref:g})]}),(0,r.jsxs)("div",{className:o.A.inputContainer,children:[(0,r.jsx)("textarea",{value:t,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f())},placeholder:"Ask a question about your documents...",className:o.A.input,rows:3,disabled:c||!d?.is_initialized}),(0,r.jsxs)("button",{onClick:f,disabled:c||!t.trim()||!d?.is_initialized,className:o.A.sendButton,children:[c?"\u23f3":"\ud83d\ude80"," Send"]})]})]})})}},9343:(e,s,t)=>{t.d(s,{A:()=>a});const a={chatContainer:"chatContainer_KH0L",chatHeader:"chatHeader_reD8",messagesContainer:"messagesContainer_SFO7",message:"message_zSPE",fadeIn:"fadeIn_Zemu",userMessage:"userMessage_lvhv",assistantMessage:"assistantMessage_Uwyp",messageHeader:"messageHeader_K4GA",messageRole:"messageRole_hhwq",messageTime:"messageTime_ZVuy",messageContent:"messageContent_aDu0",sources:"sources_MWZu",sourcesHeader:"sourcesHeader_B4TJ",source:"source_kCO2",sourceLink:"sourceLink_zD8c",relevance:"relevance_Tz3Y",loadingDots:"loadingDots_I78e",bounce:"bounce_tdVV",inputForm:"inputForm_C6y2",input:"input_HGmo",sendButton:"sendButton_T1Fb"}}}]);